(this.webpackJsonpfullstackopen=this.webpackJsonpfullstackopen||[]).push([[0],{120:function(e,t,n){},207:function(e,t,n){},208:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(22),s=n.n(c),o=(n(120),n(21)),i=n.n(o),u=n(78),l=n(33),j=n(31),p=n(112),d=n(111),b=n(213),h=n(214),f=n(7),O=function(e){var t=e.buttonLabel,n=e.children,a=Object(r.useState)(!1),c=Object(j.a)(a,2),s=c[0],o=c[1],i={display:s?"none":""},u={display:s?"":"none"},l=function(){o(!s)};return Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{style:i,children:Object(f.jsx)(d.a,{onClick:l,children:t})}),Object(f.jsxs)("div",{style:u,children:[n,Object(f.jsx)(d.a,{style:{marginTop:10},onClick:l,children:"cancel"})]})]})},x=function(e){var t=e.note,n=t.content,r=t.important,a=e.toggleImportant,c=e.index;return Object(f.jsxs)("li",{className:"note",children:[Object(f.jsx)("span",{children:"".concat(c,". ")}),Object(f.jsx)("span",{children:n}),Object(f.jsx)(d.a,{onClick:a,style:{marginLeft:10},children:r?"make no important":"make important"})]})},m=n(210),g=n(211),v=function(e){var t=e.handleLogin,n=Object(r.useState)(""),a=Object(j.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(""),i=Object(j.a)(o,2),u=i[0],l=i[1];return Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Login"}),Object(f.jsxs)(m.a,{onFinish:function(){s(""),l(""),t({username:c,password:u})},children:[Object(f.jsx)(m.a.Item,{label:"Username",name:"username",children:Object(f.jsx)(g.a,{id:"username",type:"text",placeholder:"\u8bf7\u8f93\u5165username",name:"username",value:c,onChange:function(e){return s(e.target.value)}})}),Object(f.jsx)(m.a.Item,{label:"Password",name:"password",children:Object(f.jsx)(g.a,{id:"password",type:"text",placeholder:"\u8bf7\u8f93\u5165password",name:"password",value:u,onChange:function(e){return l(e.target.value)}})}),Object(f.jsx)("div",{children:Object(f.jsx)(d.a,{htmlType:"submit",children:"\u767b\u5f55"})})]})]})},y=n(212),k=n(49),w=n.n(k),N="/api/notes",S=null,C={getNotes:function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get(N).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),createNote:function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:S}},e.next=3,w.a.post(N,t,n).then((function(e){return e.data}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateNote:function(){var e=Object(l.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.put("".concat(N,"/").concat(t),n).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setToken:function(e){S="bearer ".concat(e)}},L=function(e){var t=e.createNote,n=Object(r.useState)(""),a=Object(j.a)(n,2),c=a[0],s=a[1];return Object(f.jsx)("form",{onSubmit:function(e){e.preventDefault();var n={content:c,important:Math.random()<.5};t(n),s("")},children:Object(f.jsx)(g.a,{style:{width:420},size:"middle",placeholder:"\u8bf7\u8f93\u5165",value:c,addonAfter:Object(f.jsx)(d.a,{style:{height:30},htmlType:"submit",type:"text",icon:Object(f.jsx)(y.a,{}),children:"\u63d0\u4ea4"}),onChange:function(e){s(e.target.value)}})})},I={login:function(){var e=Object(l.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.post("/api/login",{username:t,password:n}).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};n(207);var T=function(){var e=Object(r.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),s=Object(j.a)(c,2),o=s[0],m=s[1],g=Object(r.useState)(!1),y=Object(j.a)(g,2),k=(y[0],y[1],Object(r.useState)(null)),w=Object(j.a)(k,2),N=w[0],S=w[1],T=o?n:n.filter((function(e){return e.important})),F=function(){var e=Object(l.a)(i.a.mark((function e(t){var r,c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.find((function(e){return e.id===t})),c=Object(u.a)(Object(u.a)({},r),{},{important:!r.important}),e.next=4,C.updateNote(t,c);case 4:s=e.sent,a(n.map((function(e){return e.id===t?s:e})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(l.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="addNoteMessageKey",p.b.loading({content:"\u6dfb\u52a0\u4e2d...",key:r}),e.prev=2,e.next=5,C.createNote(t);case 5:p.b.success({content:"\u6dfb\u52a0\u6210\u529f",key:r}),a(n.concat(t)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),p.b.error({content:"\u6dfb\u52a0\u5931\u8d25",key:r});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,console.log(n,r,"handleLogin"),a="loginMessageKey",p.b.loading({content:"\u767b\u9646\u4e2d...",key:a}),e.prev=4,e.next=7,I.login(n,r);case 7:c=e.sent,p.b.success({content:"\u767b\u5f55\u6210\u529f",key:a}),localStorage.setItem("loggedNoteappUser",JSON.stringify(c)),C.setToken(c.token),S(c),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),console.log(e.t0,e.t0.response,"error---"),p.b.warning({content:"\u767b\u5f55\u5931\u8d25: ".concat(e.t0.response.data.error),key:a});case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){C.getNotes().then((function(e){return a(e)}))}),[]),Object(r.useEffect)((function(){var e=localStorage.getItem("loggedNoteappUser");if(e){var t=JSON.parse(e);S(t),C.setToken(t.token)}}),[]),Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)("h1",{children:"notes"}),Object(f.jsx)("div",{style:{margin:"10xp 0"},children:N?Object(f.jsxs)("div",{children:[Object(f.jsxs)("p",{children:[Object(f.jsx)("span",{children:N.name}),Object(f.jsx)("span",{children:"logged in"}),Object(f.jsx)(d.a,{type:"link",onClick:function(){localStorage.setItem("loggedNoteappUser",""),C.setToken(null),S(null)},children:"\u9000\u51fa"})]}),Object(f.jsx)(O,{buttonLabel:Object(f.jsxs)("span",{children:[Object(f.jsx)(h.a,{})," ","new note"]}),children:Object(f.jsx)(L,{createNote:J})})]}):Object(f.jsx)(O,{buttonLabel:Object(f.jsxs)("span",{children:[Object(f.jsx)(b.a,{}),Object(f.jsx)("span",{style:{marginLeft:8},children:"\u767b\u5f55"})]}),children:Object(f.jsx)(v,{handleLogin:M})})}),Object(f.jsx)(d.a,{style:{margin:"10px 0"},onClick:function(){m(!o)},children:o?"show important":"show all"}),Object(f.jsx)("ul",{children:T.map((function(e,t){return Object(f.jsx)(x,{note:e,index:t,toggleImportant:function(){return F(e.id)}},t)}))})]})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,215)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(T,{})}),document.getElementById("root")),F()}},[[208,1,2]]]);
//# sourceMappingURL=main.769881b2.chunk.js.map